[project]
name = "robostack"
description = "Development environment for RoboStack ROS packages"
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64", "win-64", "osx-64", "osx-arm64", "linux-aarch64"]

# ROS environment is automatically activated by RoboStack via conda activation scripts
# Additional environment configuration for ROS DDS settings

[target.unix.activation]
scripts = ["scripts/activate-cyclonedds.sh"]

[target.win.activation]
scripts = ["scripts/activate-cyclonedds.bat"]

# To build you can use - `pixi run -e <ros distro> build <Any other temporary args>`
[feature.build.target.win-64.tasks]
build = "colcon build --merge-install --cmake-args -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DPython_FIND_VIRTUALENV=ONLY -DPython3_FIND_VIRTUALENV=ONLY"

[feature.build.target.unix.tasks]
build = "colcon build --symlink-install --cmake-args -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DPython_FIND_VIRTUALENV=ONLY -DPython3_FIND_VIRTUALENV=ONLY"

[tasks]
build = { cmd = "colcon build --symlink-install --install-base .pixi/envs/jazzy --merge-install" }
clean = { cmd = "rm -rf build/ log/ .pixi/envs/jazzy/share/tof_slam_sim .pixi/envs/jazzy/lib/tof_slam_sim" }
rebuild = { cmd = "pixi run clean && pixi run build" }
sim = { cmd = "ros2 launch tof_slam_sim sim_with_bridge.launch.py" }
slam = { cmd = "ros2 launch tof_slam_sim slam_test.launch.py" }

# Dependencies used by all environments
[dependencies]
python = "*"
# Build tools
compilers = "*"
cmake = "*"
pkg-config = "*"
make = "*"
ninja = "*"
# ROS specific tools
rosdep = "*"
colcon-common-extensions = "*"

[target.linux.dependencies]
libgl-devel = "*"

# Define all the different ROS environments
# Each environment corresponds to a different ROS distribution
# and can be activated using the `pixi run/shell -e <environment>` command.
[environments]
# noetic = { features = ["noetic", "build"] }
# humble = { features = ["humble", "build"] }
jazzy = { features = ["jazzy", "build"] }
# kilted = { features = ["kilted", "build"] }

### ROS Noetic ####  
# [feature.noetic]
# channels = ["https://prefix.dev/robostack-noetic"]

# [feature.noetic.dependencies]
# ros-noetic-desktop = "*"
# catkin_tools = "*"

# ### ROS Humble ####
# [feature.humble]
# channels = ["https://prefix.dev/robostack-humble"]

# [feature.humble.dependencies]
# ros-humble-desktop = "*"

### ROS Jazzy ####
[feature.jazzy]
channels = ["https://prefix.dev/robostack-jazzy"]

[feature.jazzy.dependencies]
ros-jazzy-desktop = "*"
python = "3.12.*"
ros-jazzy-ros-base = ">=0.11.0,<0.12"
ros-jazzy-rviz2 = ">=14.1.12,<15"
ros-jazzy-ros-gz-sim = ">=1.0.16,<2"
ros-jazzy-ros-gz-interfaces = ">=1.0.16,<2"
ros-jazzy-ros-gz-bridge = ">=1.0.16,<2"
ros-jazzy-slam-toolbox = ">=2.8.3,<3"
ros-jazzy-sensor-msgs = ">=5.3.6,<6"
ros-jazzy-geometry-msgs = ">=5.3.6,<6"
ros-jazzy-std-msgs = ">=5.3.6,<6"
ros-jazzy-nav-msgs = ">=5.3.6,<6"
colcon-common-extensions = ">=0.3.0,<0.4"
cmake = ">=4.1.1,<5"
pkg-config = ">=0.29.2,<0.30"
ninja = ">=1.13.1,<2"
numpy = ">=1.26.4,<2"
eigen = ">=3.4.0,<4"
pcl = ">=1.15.0,<2"### ROS Kilted ####
# [feature.kilted]
# channels = ["https://prefix.dev/robostack-kilted"]

# [feature.kilted.dependencies]
# ros-kilted-desktop = "*"